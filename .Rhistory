type = "response")
ggplot(model_preds, aes(x = zelemiq_avg, y = estimate)) +
geom_hline(yintercept = 0, linetype = "dashed") +
geom_ribbon(aes(ymin=conf.low, ymax=conf.high), alpha = 0.25) +
geom_line(size=1) +
geom_point(data=data, aes(y=lactate), alpha=0.25) +
labs(x = "Zelemiq Ltd Output",
y = bquote("Blood Lactate (mmol."~L^-1~")"),
title = "Conditional model predictions") +
theme_bw() +
theme(panel.grid=element_blank(),
plot.title = element_markdown())
model_adj
data |>
ggplot(aes(x = lactate, y = zelemiq_avg)) +
geom_point()
data |>
ggplot(aes(x = lactate, y = zelemiq_avg, color = id)) +
geom_point()
data |>
ggplot(aes(x = lactate, y = zelemiq_avg, color = id)) +
geom_point() +
geom_smooth()
data |>
ggplot(aes(x = lactate, y = zelemiq_avg, color = id)) +
geom_point() +
geom_smooth(se=FALSE)
data |>
ggplot(aes(x = lactate, y = zelemiq_avg, color = id)) +
geom_point() +
geom_smooth(se=FALSE, method = "lm")
data |>
ggplot(aes(x = log(lactate), y = zelemiq_avg, color = id)) +
geom_point() +
geom_smooth(se=FALSE, method = "lm")
data |>
ggplot(aes(x = lactate, y = log(zelemiq_avg), color = id)) +
geom_point() +
geom_smooth(se=FALSE, method = "lm")
data |>
ggplot(aes(x = lactate, y = log(zelemiq_avg))) +
geom_point() +
geom_smooth(se=FALSE, method = "lm") +
facet_wrap("id")
data |>
ggplot(aes(x = lactate, y = zelemiq_avg)) +
geom_point() +
geom_smooth(se=FALSE, method = "lm") +
facet_wrap("id")
data |>
ggplot(aes(y = lactate, x = zelemiq_avg)) +
geom_point() +
geom_smooth(se=FALSE, method = "lm") +
facet_wrap("id")
data |>
ggplot(aes(y = log(lactate), x = zelemiq_avg)) +
geom_point() +
geom_smooth(se=FALSE, method = "lm") +
facet_wrap("id")
model <- lmer(log(lactate) ~ zelemiq_avg + (zelemiq_avg | id),
data = data,
REML = TRUE
)
model <- lmer(log(lactate) ~ zelemiq_avg + (zelemiq_avg | id),
data = data,
REML = TRUE,
control = optim("NelderMead")
)
model <- lmer(log(lactate) ~ zelemiq_avg + (zelemiq_avg | id),
data = data,
REML = TRUE
)
performance::check_model(model)
model_preds <- predictions(model,
newdata = datagrid(id = NA,
zelemiq_avg = seq(0.4,0.6, by=0.01)),
re.form = NA,
type = "response")
ggplot(model_preds, aes(x = zelemiq_avg, y = estimate)) +
geom_hline(yintercept = 0, linetype = "dashed") +
geom_ribbon(aes(ymin=conf.low, ymax=conf.high), alpha = 0.25) +
geom_line(size=1) +
geom_point(data=data, aes(y=lactate), alpha=0.25) +
labs(x = "Zelemiq Ltd Output",
y = bquote("Blood Lactate (mmol."~L^-1~")"),
title = "Conditional model predictions") +
theme_bw() +
theme(panel.grid=element_blank(),
plot.title = element_markdown())
plot(model_preds)
plot_predictions(model_preds)
plot_predictions(model_preds, condition = "zelemiq_avg")
plot_predictions(model, condition = "zelemiq_avg")
?plot_predictions
plot_predictions(model, condition = "zelemiq_avg",
points = 1)
model
plot_predictions(model, condition = "zelemiq_avg",
points = 1,
type = "response")
model <- glmer(lactate ~ zelemiq_avg + (zelemiq_avg | id),
data = data,
link = "log"
)
?glmer
model <- glmer(lactate ~ zelemiq_avg + (zelemiq_avg | id),
data = data,
family = "log"
)
model <- glmer(lactate ~ zelemiq_avg + (zelemiq_avg | id),
data = data,
family = Gamma(link = "log")
)
performance::check_model(model)
plot_predictions(model, condition = "zelemiq_avg",
points = 1,
type = "response")
model_preds <- predictions(model,
newdata = datagrid(id = NA,
zelemiq_avg = seq(0.4,0.6, by=0.01)),
re.form = NA,
type = "response")
plot_predictions(model, condition = "zelemiq_avg",
points = 1,
type = "response")
ggplot(model_preds, aes(x = zelemiq_avg, y = estimate)) +
geom_hline(yintercept = 0, linetype = "dashed") +
geom_ribbon(aes(ymin=conf.low, ymax=conf.high), alpha = 0.25) +
geom_line(size=1) +
geom_point(data=data, aes(y=lactate), alpha=0.25) +
labs(x = "Zelemiq Ltd Output",
y = bquote("Blood Lactate (mmol."~L^-1~")"),
title = "Conditional model predictions") +
theme_bw() +
theme(panel.grid=element_blank(),
plot.title = element_markdown())
model <- glmer(lactate ~ zelemiq_avg + (zelemiq_avg | id),
data = data,
family = Gamma(link = "identity")
)
performance::check_model(model)
plot_predictions(model, condition = "zelemiq_avg",
points = 1,
type = "response")
model <- glmer(lactate ~ zelemiq_avg + (zelemiq_avg | id),
data = data,
family = Gamma(link = "inverse")
)
performance::check_model(model)
plot_predictions(model, condition = "zelemiq_avg",
points = 1,
type = "response")
model <- brm(lactate ~ zelemiq_avg + (zelemiq_avg | id),
data = data,
family = Gamma(link = "log")
)
plot(model)
pp_check(model)
model_preds <- predictions(model,
newdata = datagrid(id = NA,
zelemiq_avg = seq(0.4,0.6, by=0.01)),
re_formula = NA,
type = "response")
ggplot(model_preds, aes(x = zelemiq_avg, y = estimate)) +
geom_hline(yintercept = 0, linetype = "dashed") +
geom_ribbon(aes(ymin=conf.low, ymax=conf.high), alpha = 0.25) +
geom_line(size=1) +
geom_point(data=data, aes(y=lactate), alpha=0.25) +
labs(x = "Zelemiq Ltd Output",
y = bquote("Blood Lactate (mmol."~L^-1~")"),
title = "Conditional model predictions") +
theme_bw() +
theme(panel.grid=element_blank(),
plot.title = element_markdown())
model_exp <- brm(lactate ~ zelemiq_avg + (zelemiq_avg | id),
data = data,
family = exponential(link = "log"),
save_pars = save_pars(all = TRUE)
)
plot(model)
pp_check(model)
plot_predictions(model)
plot_predictions(model, condition = "zelemiq_avg")
model_preds <- predictions(model,
newdata = datagrid(id = NA,
zelemiq_avg = seq(0.4,0.6, by=0.01)),
re_formula = NA,
type = "response")
ggplot(model_preds, aes(x = zelemiq_avg, y = estimate)) +
geom_hline(yintercept = 0, linetype = "dashed") +
geom_ribbon(aes(ymin=conf.low, ymax=conf.high), alpha = 0.25) +
geom_line(size=1) +
geom_point(data=data, aes(y=lactate), alpha=0.25) +
labs(x = "Zelemiq Ltd Output",
y = bquote("Blood Lactate (mmol."~L^-1~")"),
title = "Conditional model predictions") +
theme_bw() +
theme(panel.grid=element_blank(),
plot.title = element_markdown())
model_preds <- predictions(model,
newdata = datagrid(id = NA,
zelemiq_avg = seq(0.4,0.6, by=0.01)),
re_formula = NULL,
type = "response")
plot_predictions(model, condition = "zelemiq_avg",
points = 1,
type = "response")
ggplot(model_preds, aes(x = zelemiq_avg, y = estimate)) +
geom_hline(yintercept = 0, linetype = "dashed") +
geom_ribbon(aes(ymin=conf.low, ymax=conf.high), alpha = 0.25) +
geom_line(size=1) +
geom_point(data=data, aes(y=lactate), alpha=0.25) +
labs(x = "Zelemiq Ltd Output",
y = bquote("Blood Lactate (mmol."~L^-1~")"),
title = "Conditional model predictions") +
theme_bw() +
theme(panel.grid=element_blank(),
plot.title = element_markdown())
plot(model_exp)
plot_predictions(model_exp, condition = "zelemiq_avg", points = 1)
pp_check(model_exp)
model_gamma <- brm(lactate ~ zelemiq_avg + (zelemiq_avg | id),
data = data,
family = Gamma(link = "log"),
save_pars = save_pars(all = TRUE)
)
plot(model_gamma)
pp_check(model_gamma)
plot_predictions(model_gamma, condition = "zelemiq_avg", points = 1)
bayestestR::bayesfactor_models(model_exp, model_gamma)
bayestestR::bayesfactor_models(model_exp, model_gamma, denominator = model_exp)
bf_mods <- bayestestR::bayesfactor_models(model_exp, model_gamma, denominator = model_exp)
bf_mods$log_BF
bf_mods
as.data.frame(bf_mods$log_BF)
plot_predictions(model_exp, condition = "zelemiq_avg", points = 1)
plot_predictions(model_gamma, condition = "zelemiq_avg", points = 1)
plot_predictions(model_gamma, condition = "zelemiq_avg", points = 1) +
scale_y_continuous(limits = c(0,10))
plot_predictions(model_gamma, condition = "zelemiq_avg", points = 1) +
scale_y_continuous(limits = c(0,65))
as.matrix(bf_mods)
3/4
3/1
exp(as.matrix(bf_mods))
3/1
1.34e+14
round(as.matrix(bf_mods),3)
model_preds <- predictions(model_exp,
newdata = datagrid(id = NA,
zelemiq_avg = seq(0.4,0.6, by=0.01)),
re_formula = NA,
type = "response")
model_preds_exp <- predictions(model_exp,
newdata = datagrid(id = NA,
zelemiq_avg = seq(0.4,0.6, by=0.01)),
re_formula = NA,
type = "response")
ggplot(model_preds_exp, aes(x = zelemiq_avg, y = estimate)) +
geom_hline(yintercept = 0, linetype = "dashed") +
geom_ribbon(aes(ymin=conf.low, ymax=conf.high), alpha = 0.25) +
geom_line(size=1) +
geom_point(data=data, aes(y=lactate), alpha=0.25) +
labs(x = "Zelemiq Ltd Output",
y = bquote("Blood Lactate (mmol."~L^-1~")"),
title = "Conditional model predictions") +
theme_bw() +
theme(panel.grid=element_blank(),
plot.title = element_markdown())
ind_preds <- predictions(model,
newdata = datagrid(id = data$id,
zelemiq_avg = seq(0.4,0.6, by=0.01)))
ggplot(ind_preds, aes(x = zelemiq_avg, y = estimate)) +
geom_hline(yintercept = 0, linetype = "dashed") +
geom_ribbon(aes(ymin=conf.low, ymax=conf.high), alpha = 0.25) +
geom_line(size=1) +
geom_point(data=data, aes(y=lactate), alpha=0.25) +
labs(x = "Zelemiq Ltd Output",
y = bquote("Blood Lactate (mmol."~L^-1~")"),
title = "Individual participant level predictions") +
facet_wrap("id", nrow = 2) +
theme_bw() +
theme(panel.grid=element_blank(),
plot.title = element_markdown())
ind_preds <- predictions(model_exp,
newdata = datagrid(id = data$id,
zelemiq_avg = seq(0.4,0.6, by=0.01)))
ggplot(ind_preds, aes(x = zelemiq_avg, y = estimate)) +
geom_hline(yintercept = 0, linetype = "dashed") +
geom_ribbon(aes(ymin=conf.low, ymax=conf.high), alpha = 0.25) +
geom_line(size=1) +
geom_point(data=data, aes(y=lactate), alpha=0.25) +
labs(x = "Zelemiq Ltd Output",
y = bquote("Blood Lactate (mmol."~L^-1~")"),
title = "Individual participant level predictions") +
facet_wrap("id", nrow = 2) +
theme_bw() +
theme(panel.grid=element_blank(),
plot.title = element_markdown())
model_preds_exp <- predictions(model_gamma,
newdata = datagrid(id = NA,
zelemiq_avg = seq(0.4,0.6, by=0.01)),
re_formula = NA,
type = "response")
ggplot(model_preds_exp, aes(x = zelemiq_avg, y = estimate)) +
geom_hline(yintercept = 0, linetype = "dashed") +
geom_ribbon(aes(ymin=conf.low, ymax=conf.high), alpha = 0.25) +
geom_line(size=1) +
geom_point(data=data, aes(y=lactate), alpha=0.25) +
labs(x = "Zelemiq Ltd Output",
y = bquote("Blood Lactate (mmol."~L^-1~")"),
title = "Conditional model predictions") +
theme_bw() +
theme(panel.grid=element_blank(),
plot.title = element_markdown())
ind_preds <- predictions(model_gamma,
newdata = datagrid(id = data$id,
zelemiq_avg = seq(0.4,0.6, by=0.01)))
ggplot(ind_preds, aes(x = zelemiq_avg, y = estimate)) +
geom_hline(yintercept = 0, linetype = "dashed") +
geom_ribbon(aes(ymin=conf.low, ymax=conf.high), alpha = 0.25) +
geom_line(size=1) +
geom_point(data=data, aes(y=lactate), alpha=0.25) +
labs(x = "Zelemiq Ltd Output",
y = bquote("Blood Lactate (mmol."~L^-1~")"),
title = "Individual participant level predictions") +
facet_wrap("id", nrow = 2) +
theme_bw() +
theme(panel.grid=element_blank(),
plot.title = element_markdown())
model_exgauss <- brm(lactate ~ zelemiq_avg + (zelemiq_avg | id),
data = data,
family = exgaussian(link = "identity"),
save_pars = save_pars(all = TRUE)
)
plot(model_exgauss)
model_exgauss
pp_check(model_exgauss)
model_preds_exp <- predictions(model_exgauss,
newdata = datagrid(id = NA,
zelemiq_avg = seq(0.4,0.6, by=0.01)),
re_formula = NA,
type = "response")
ggplot(model_preds_exp, aes(x = zelemiq_avg, y = estimate)) +
geom_hline(yintercept = 0, linetype = "dashed") +
geom_ribbon(aes(ymin=conf.low, ymax=conf.high), alpha = 0.25) +
geom_line(size=1) +
geom_point(data=data, aes(y=lactate), alpha=0.25) +
labs(x = "Zelemiq Ltd Output",
y = bquote("Blood Lactate (mmol."~L^-1~")"),
title = "Conditional model predictions") +
theme_bw() +
theme(panel.grid=element_blank(),
plot.title = element_markdown())
ind_preds <- predictions(model_exgauss,
newdata = datagrid(id = data$id,
zelemiq_avg = seq(0.4,0.6, by=0.01)))
ggplot(ind_preds, aes(x = zelemiq_avg, y = estimate)) +
geom_hline(yintercept = 0, linetype = "dashed") +
geom_ribbon(aes(ymin=conf.low, ymax=conf.high), alpha = 0.25) +
geom_line(size=1) +
geom_point(data=data, aes(y=lactate), alpha=0.25) +
labs(x = "Zelemiq Ltd Output",
y = bquote("Blood Lactate (mmol."~L^-1~")"),
title = "Individual participant level predictions") +
facet_wrap("id", nrow = 2) +
theme_bw() +
theme(panel.grid=element_blank(),
plot.title = element_markdown())
bf_mods <- bayestestR::bayesfactor_models(model_exp, model_gamma, model_exgauss, denominator = model_exp)
round(as.matrix(bf_mods),3)
log(3/1)
log(1/3)
bf_mods
get_prior(lactate ~ zelemiq_avg + (zelemiq_avg | id),
data = data,
family = exponential(link = "log"))
get_prior(lactate ~ zelemiq_avg + (zelemiq_avg | id),
data = data,
family = exponential(link = "log"))
get_prior(lactate ~ zelemiq_avg + (zelemiq_avg | id),
data = data)
plot_predictions(model_exp, condition = "zelemiq_avg")
model_preds_exp <- predictions(model_exp,
newdata = datagrid(id = NA,
zelemiq_avg = seq(0.4,0.6, by=0.01)),
re_formula = NA)
ggplot(model_preds_exp, aes(x = zelemiq_avg, y = estimate)) +
geom_hline(yintercept = 0, linetype = "dashed") +
geom_ribbon(aes(ymin=conf.low, ymax=conf.high), alpha = 0.25) +
geom_line(size=1) +
geom_point(data=data, aes(y=lactate), alpha=0.25) +
labs(x = "Zelemiq Ltd Output",
y = bquote("Blood Lactate (mmol."~L^-1~")"),
title = "Conditional model predictions") +
theme_bw() +
theme(panel.grid=element_blank(),
plot.title = element_markdown())
model_gamma <- brm(lactate ~ zelemiq_avg + (zelemiq_avg | id),
data = data,
family = Gamma(link = "inverse"),
save_pars = save_pars(all = TRUE)
)
plot(model_gamma)
model_preds_exp <- predictions(model_gamma,
newdata = datagrid(id = NA,
zelemiq_avg = seq(0.4,0.6, by=0.01)),
re_formula = NA,
type = "response")
ggplot(model_preds_exp, aes(x = zelemiq_avg, y = estimate)) +
geom_hline(yintercept = 0, linetype = "dashed") +
geom_ribbon(aes(ymin=conf.low, ymax=conf.high), alpha = 0.25) +
geom_line(size=1) +
geom_point(data=data, aes(y=lactate), alpha=0.25) +
labs(x = "Zelemiq Ltd Output",
y = bquote("Blood Lactate (mmol."~L^-1~")"),
title = "Conditional model predictions") +
theme_bw() +
theme(panel.grid=element_blank(),
plot.title = element_markdown())
ind_preds <- predictions(model_gamma,
newdata = datagrid(id = data$id,
zelemiq_avg = seq(0.4,0.6, by=0.01)))
ggplot(ind_preds, aes(x = zelemiq_avg, y = estimate)) +
geom_hline(yintercept = 0, linetype = "dashed") +
geom_ribbon(aes(ymin=conf.low, ymax=conf.high), alpha = 0.25) +
geom_line(size=1) +
geom_point(data=data, aes(y=lactate), alpha=0.25) +
labs(x = "Zelemiq Ltd Output",
y = bquote("Blood Lactate (mmol."~L^-1~")"),
title = "Individual participant level predictions") +
facet_wrap("id", nrow = 2) +
theme_bw() +
theme(panel.grid=element_blank(),
plot.title = element_markdown())
model_gamma <- brm(lactate ~ zelemiq_avg + (zelemiq_avg | id),
data = data,
family = Gamma(link = "identity"),
save_pars = save_pars(all = TRUE)
)
plot(model_gamma)
pp_check(model_gamma)
model_preds_exp <- predictions(model_gamma,
newdata = datagrid(id = NA,
zelemiq_avg = seq(0.4,0.6, by=0.01)),
re_formula = NA,
type = "response")
ggplot(model_preds_exp, aes(x = zelemiq_avg, y = estimate)) +
geom_hline(yintercept = 0, linetype = "dashed") +
geom_ribbon(aes(ymin=conf.low, ymax=conf.high), alpha = 0.25) +
geom_line(size=1) +
geom_point(data=data, aes(y=lactate), alpha=0.25) +
labs(x = "Zelemiq Ltd Output",
y = bquote("Blood Lactate (mmol."~L^-1~")"),
title = "Conditional model predictions") +
theme_bw() +
theme(panel.grid=element_blank(),
plot.title = element_markdown())
ind_preds <- predictions(model_gamma,
newdata = datagrid(id = data$id,
zelemiq_avg = seq(0.4,0.6, by=0.01)))
ggplot(ind_preds, aes(x = zelemiq_avg, y = estimate)) +
geom_hline(yintercept = 0, linetype = "dashed") +
geom_ribbon(aes(ymin=conf.low, ymax=conf.high), alpha = 0.25) +
geom_line(size=1) +
geom_point(data=data, aes(y=lactate), alpha=0.25) +
labs(x = "Zelemiq Ltd Output",
y = bquote("Blood Lactate (mmol."~L^-1~")"),
title = "Individual participant level predictions") +
facet_wrap("id", nrow = 2) +
theme_bw() +
theme(panel.grid=element_blank(),
plot.title = element_markdown())
model_gamma
model_exgauss <- brm(lactate ~ zelemiq_avg + (zelemiq_avg | id),
data = data,
family = exgaussian(link = "log"),
save_pars = save_pars(all = TRUE)
)
plot(model_exgauss)
pp_check(model_exgauss)
model_preds_exp <- predictions(model_exgauss,
newdata = datagrid(id = NA,
zelemiq_avg = seq(0.4,0.6, by=0.01)),
re_formula = NA,
type = "response")
ggplot(model_preds_exp, aes(x = zelemiq_avg, y = estimate)) +
geom_hline(yintercept = 0, linetype = "dashed") +
geom_ribbon(aes(ymin=conf.low, ymax=conf.high), alpha = 0.25) +
geom_line(size=1) +
geom_point(data=data, aes(y=lactate), alpha=0.25) +
labs(x = "Zelemiq Ltd Output",
y = bquote("Blood Lactate (mmol."~L^-1~")"),
title = "Conditional model predictions") +
theme_bw() +
theme(panel.grid=element_blank(),
plot.title = element_markdown())
ind_preds <- predictions(model_exgauss,
newdata = datagrid(id = data$id,
zelemiq_avg = seq(0.4,0.6, by=0.01)))
ggplot(ind_preds, aes(x = zelemiq_avg, y = estimate)) +
geom_hline(yintercept = 0, linetype = "dashed") +
geom_ribbon(aes(ymin=conf.low, ymax=conf.high), alpha = 0.25) +
geom_line(size=1) +
geom_point(data=data, aes(y=lactate), alpha=0.25) +
labs(x = "Zelemiq Ltd Output",
y = bquote("Blood Lactate (mmol."~L^-1~")"),
title = "Individual participant level predictions") +
facet_wrap("id", nrow = 2) +
theme_bw() +
theme(panel.grid=element_blank(),
plot.title = element_markdown())
