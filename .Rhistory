x = 135,
y = 235,
size = 2
) +
geom_text(data = thresholds_agree,
aes(label = glue::glue("Upper LOA = {round(upper_loa,2)} [95%CI: {round(upper_loa_lower,2)}, {round(upper_loa_upper,2)}]")),
x = 135,
y = 220,
size = 2
) +
geom_text(data = thresholds_agree,
aes(label = glue::glue("rho[CCC] == {round(ccc,2)}", "[95CI {round(upper_loa_lower,2)}, {round(upper_loa_upper,2)}]")),
x = 135,
y = 205,
size = 2,
parse = TRUE
) +
facet_grid("method") +
labs(x = "Threshold determined by blood lactate (Watts)",
y = "Threshold determined by Zelemiq Ltd (Watts)",
title = "Agreement of thresholds detected by different methods") +
theme_bw() +
theme(panel.grid=element_blank(),
plot.title = element_markdown())
thresholds |>
filter(str_detect(method, pattern = "Log", negate = TRUE)) |>
ggplot(aes(x = intensity_lactate, y = intensity_zelemiq)) +
geom_abline(intercept = 0, slope = 1, linetype = "dashed") +
geom_point() +
geom_text(data = thresholds_agree,
aes(label = glue::glue("Bias = {round(bias,2)} [95%CI: {round(bias_lower,2)}, {round(bias_upper,2)}]")),
x = 135,
y = 250,
size = 2
) +
geom_text(data = thresholds_agree,
aes(label = glue::glue("Lower LOA = {round(lower_loa,2)} [95%CI: {round(lower_loa_lower,2)}, {round(lower_loa_upper,2)}]")),
x = 135,
y = 235,
size = 2
) +
geom_text(data = thresholds_agree,
aes(label = glue::glue("Upper LOA = {round(upper_loa,2)} [95%CI: {round(upper_loa_lower,2)}, {round(upper_loa_upper,2)}]")),
x = 135,
y = 220,
size = 2
) +
geom_text(data = thresholds_agree,
aes(label = glue::glue("rho[CCC] == {round(ccc,2)}", "[95CI == {round(upper_loa_lower,2)}, {round(upper_loa_upper,2)}]")),
x = 135,
y = 205,
size = 2,
parse = TRUE
) +
facet_grid("method") +
labs(x = "Threshold determined by blood lactate (Watts)",
y = "Threshold determined by Zelemiq Ltd (Watts)",
title = "Agreement of thresholds detected by different methods") +
theme_bw() +
theme(panel.grid=element_blank(),
plot.title = element_markdown())
thresholds |>
filter(str_detect(method, pattern = "Log", negate = TRUE)) |>
ggplot(aes(x = intensity_lactate, y = intensity_zelemiq)) +
geom_abline(intercept = 0, slope = 1, linetype = "dashed") +
geom_point() +
geom_text(data = thresholds_agree,
aes(label = glue::glue("Bias = {round(bias,2)} [95%CI: {round(bias_lower,2)}, {round(bias_upper,2)}]")),
x = 135,
y = 250,
size = 2
) +
geom_text(data = thresholds_agree,
aes(label = glue::glue("Lower LOA = {round(lower_loa,2)} [95%CI: {round(lower_loa_lower,2)}, {round(lower_loa_upper,2)}]")),
x = 135,
y = 235,
size = 2
) +
geom_text(data = thresholds_agree,
aes(label = glue::glue("Upper LOA = {round(upper_loa,2)} [95%CI: {round(upper_loa_lower,2)}, {round(upper_loa_upper,2)}]")),
x = 135,
y = 220,
size = 2
) +
geom_text(data = thresholds_agree,
aes(label = glue::glue("rho[CCC] == {round(ccc,2)}", "95CI == {round(upper_loa_lower,2)}, {round(upper_loa_upper,2)}")),
x = 135,
y = 205,
size = 2,
parse = TRUE
) +
facet_grid("method") +
labs(x = "Threshold determined by blood lactate (Watts)",
y = "Threshold determined by Zelemiq Ltd (Watts)",
title = "Agreement of thresholds detected by different methods") +
theme_bw() +
theme(panel.grid=element_blank(),
plot.title = element_markdown())
thresholds |>
filter(str_detect(method, pattern = "Log", negate = TRUE)) |>
ggplot(aes(x = intensity_lactate, y = intensity_zelemiq)) +
geom_abline(intercept = 0, slope = 1, linetype = "dashed") +
geom_point() +
geom_text(data = thresholds_agree,
aes(label = glue::glue("Bias = {round(bias,2)} [95%CI: {round(bias_lower,2)}, {round(bias_upper,2)}]")),
x = 135,
y = 250,
size = 2
) +
geom_text(data = thresholds_agree,
aes(label = glue::glue("Lower LOA = {round(lower_loa,2)} [95%CI: {round(lower_loa_lower,2)}, {round(lower_loa_upper,2)}]")),
x = 135,
y = 235,
size = 2
) +
geom_text(data = thresholds_agree,
aes(label = glue::glue("Upper LOA = {round(upper_loa,2)} [95%CI: {round(upper_loa_lower,2)}, {round(upper_loa_upper,2)}]")),
x = 135,
y = 220,
size = 2
) +
geom_text(data = thresholds_agree,
aes(label = paste(glue::glue("rho[CCC] == {round(ccc,2)}"), glue::glue"[95%CI {round(upper_loa_lower,2)}, {round(upper_loa_upper,2)}]")),
thresholds |>
filter(str_detect(method, pattern = "Log", negate = TRUE)) |>
ggplot(aes(x = intensity_lactate, y = intensity_zelemiq)) +
geom_abline(intercept = 0, slope = 1, linetype = "dashed") +
geom_point() +
geom_text(data = thresholds_agree,
aes(label = glue::glue("Bias = {round(bias,2)} [95%CI: {round(bias_lower,2)}, {round(bias_upper,2)}]")),
x = 135,
y = 250,
size = 2
) +
geom_text(data = thresholds_agree,
aes(label = glue::glue("Lower LOA = {round(lower_loa,2)} [95%CI: {round(lower_loa_lower,2)}, {round(lower_loa_upper,2)}]")),
x = 135,
y = 235,
size = 2
) +
geom_text(data = thresholds_agree,
aes(label = glue::glue("Upper LOA = {round(upper_loa,2)} [95%CI: {round(upper_loa_lower,2)}, {round(upper_loa_upper,2)}]")),
x = 135,
y = 220,
size = 2
) +
geom_text(data = thresholds_agree,
aes(label = paste(glue::glue("rho[CCC] == {round(ccc,2)} [95%CI {round(upper_loa_lower,2)}, {round(upper_loa_upper,2)}]"))),
x = 135,
y = 205,
size = 2,
parse = TRUE
) +
facet_grid("method") +
labs(x = "Threshold determined by blood lactate (Watts)",
y = "Threshold determined by Zelemiq Ltd (Watts)",
title = "Agreement of thresholds detected by different methods") +
theme_bw() +
theme(panel.grid=element_blank(),
plot.title = element_markdown())
thresholds |>
filter(str_detect(method, pattern = "Log", negate = TRUE)) |>
ggplot(aes(x = intensity_lactate, y = intensity_zelemiq)) +
geom_abline(intercept = 0, slope = 1, linetype = "dashed") +
geom_point() +
geom_text(data = thresholds_agree,
aes(label = glue::glue("Bias = {round(bias,2)} [95%CI: {round(bias_lower,2)}, {round(bias_upper,2)}]")),
x = 135,
y = 250,
size = 2
) +
geom_text(data = thresholds_agree,
aes(label = glue::glue("Lower LOA = {round(lower_loa,2)} [95%CI: {round(lower_loa_lower,2)}, {round(lower_loa_upper,2)}]")),
x = 135,
y = 235,
size = 2
) +
geom_text(data = thresholds_agree,
aes(label = glue::glue("Upper LOA = {round(upper_loa,2)} [95%CI: {round(upper_loa_lower,2)}, {round(upper_loa_upper,2)}]")),
x = 135,
y = 220,
size = 2
) +
geom_text(data = thresholds_agree,
aes(label = paste(glue::glue("rho[CCC] == {round(ccc,2)} deparse([95%CI {round(upper_loa_lower,2)}, {round(upper_loa_upper,2)}])"))),
x = 135,
y = 205,
size = 2,
parse = TRUE
) +
facet_grid("method") +
labs(x = "Threshold determined by blood lactate (Watts)",
y = "Threshold determined by Zelemiq Ltd (Watts)",
title = "Agreement of thresholds detected by different methods") +
theme_bw() +
theme(panel.grid=element_blank(),
plot.title = element_markdown())
thresholds_agree
thresholds |>
filter(str_detect(method, pattern = "Log", negate = TRUE)) |>
ggplot(aes(x = intensity_lactate, y = intensity_zelemiq)) +
geom_abline(intercept = 0, slope = 1, linetype = "dashed") +
geom_point() +
geom_text(data = thresholds_agree,
aes(label = glue::glue("Bias = {round(bias,2)} [95%CI: {round(bias_lower,2)}, {round(bias_upper,2)}]")),
x = 135,
y = 250,
size = 2
) +
geom_text(data = thresholds_agree,
aes(label = glue::glue("Lower LOA = {round(lower_loa,2)} [95%CI: {round(lower_loa_lower,2)}, {round(lower_loa_upper,2)}]")),
x = 135,
y = 235,
size = 2
) +
geom_text(data = thresholds_agree,
aes(label = glue::glue("Upper LOA = {round(upper_loa,2)} [95%CI: {round(upper_loa_lower,2)}, {round(upper_loa_upper,2)}]")),
x = 135,
y = 220,
size = 2
) +
geom_text(data = thresholds_agree,
aes(label = paste(glue::glue("rho[CCC] == {round(ccc,2)}"))),
x = 235,
y = 125,
size = 2,
parse = TRUE
) +
geom_text(data = thresholds_agree,
aes(label = glue::glue("[95%CI: {round(ccc_lower,2)}, {round(ccc_upper,2)}]")),
x = 235,
y = 1110,
size = 2
) +
facet_grid("method") +
labs(x = "Threshold determined by blood lactate (Watts)",
y = "Threshold determined by Zelemiq Ltd (Watts)",
title = "Agreement of thresholds detected by different methods") +
theme_bw() +
theme(panel.grid=element_blank(),
plot.title = element_markdown())
thresholds |>
filter(str_detect(method, pattern = "Log", negate = TRUE)) |>
ggplot(aes(x = intensity_lactate, y = intensity_zelemiq)) +
geom_abline(intercept = 0, slope = 1, linetype = "dashed") +
geom_point() +
geom_text(data = thresholds_agree,
aes(label = glue::glue("Bias = {round(bias,2)} [95%CI: {round(bias_lower,2)}, {round(bias_upper,2)}]")),
x = 135,
y = 250,
size = 2
) +
geom_text(data = thresholds_agree,
aes(label = glue::glue("Lower LOA = {round(lower_loa,2)} [95%CI: {round(lower_loa_lower,2)}, {round(lower_loa_upper,2)}]")),
x = 135,
y = 235,
size = 2
) +
geom_text(data = thresholds_agree,
aes(label = glue::glue("Upper LOA = {round(upper_loa,2)} [95%CI: {round(upper_loa_lower,2)}, {round(upper_loa_upper,2)}]")),
x = 135,
y = 220,
size = 2
) +
geom_text(data = thresholds_agree,
aes(label = paste(glue::glue("rho[CCC] == {round(ccc,2)}"))),
x = 235,
y = 125,
size = 2,
parse = TRUE
) +
geom_text(data = thresholds_agree,
aes(label = glue::glue("[95%CI: {round(ccc_lower,2)}, {round(ccc_upper,2)}]")),
x = 235,
y = 110,
size = 2
) +
facet_grid("method") +
labs(x = "Threshold determined by blood lactate (Watts)",
y = "Threshold determined by Zelemiq Ltd (Watts)",
title = "Agreement of thresholds detected by different methods") +
theme_bw() +
theme(panel.grid=element_blank(),
plot.title = element_markdown())
thresholds |>
filter(str_detect(method, pattern = "Log", negate = TRUE)) |>
ggplot(aes(x = intensity_lactate, y = intensity_zelemiq)) +
geom_abline(intercept = 0, slope = 1, linetype = "dashed") +
geom_point() +
geom_text(data = thresholds_agree,
aes(label = glue::glue("Bias = {round(bias,2)} [95%CI: {round(bias_lower,2)}, {round(bias_upper,2)}]")),
x = 135,
y = 250,
size = 2
) +
geom_text(data = thresholds_agree,
aes(label = glue::glue("Lower LOA = {round(lower_loa,2)} [90%CI: {round(lower_loa_lower,2)}, {round(lower_loa_upper,2)}]")),
x = 135,
y = 235,
size = 2
) +
geom_text(data = thresholds_agree,
aes(label = glue::glue("Upper LOA = {round(upper_loa,2)} [90%CI: {round(upper_loa_lower,2)}, {round(upper_loa_upper,2)}]")),
x = 135,
y = 220,
size = 2
) +
geom_text(data = thresholds_agree,
aes(label = paste(glue::glue("rho[CCC] == {round(ccc,2)}"))),
x = 235,
y = 125,
size = 2,
parse = TRUE
) +
geom_text(data = thresholds_agree,
aes(label = glue::glue("[95%CI: {round(ccc_lower,2)}, {round(ccc_upper,2)}]")),
x = 235,
y = 110,
size = 2
) +
facet_grid("method") +
labs(x = "Threshold determined by blood lactate (Watts)",
y = "Threshold determined by Zelemiq Ltd (Watts)",
title = "Agreement of thresholds detected by different methods") +
theme_bw() +
theme(panel.grid=element_blank(),
plot.title = element_markdown())
targets::tar_make()
targets::tar_make()
targets::tar_make()
targets::tar_load(thresholds)
targets::tar_make()
targets::tar_load(thresholds)
data_thresholds <- data |>
group_by(id) |>
filter(!is.na(lactate)) |>
mutate(intensity = seq_len(n()),
intensity = case_when(
intensity == 1 ~ 50,
intensity == 2 ~ 100,
intensity == 3 ~ 125,
intensity == 4 ~ 150,
intensity == 5 ~ 175,
intensity == 6 ~ 200,
intensity == 7 ~ 225,
intensity == 8 ~ 250,
intensity == 9 ~ 275,
intensity == 10 ~ 300
)) |>
ungroup() |>
select(id, intensity, lactate_z, zelemiq_avg_z)
thresholds <- data.frame(
id = character(),
method_category = factor(),
method = factor(),
fitting = character(),
intensity_lactate = as.numeric(),
lactate = as.numeric(),
intensity_zelemiq = as.numeric(),
zelemiq = as.numeric()
)
for(i in unique(data_thresholds$id)) {
lactate_thresholds <- data_thresholds |>
filter(id == i) |>
lactate_threshold(
intensity_column = "intensity",
lactate_column = "lactate_z",
fit = "3rd degree polynomial",
method = c("Log-log", "Dmax", "LTP"),
include_baseline = TRUE,
sport = "cycling",
loglog_restrainer = 1,
plot = FALSE
)
zelemiq_thresholds <- data_thresholds |>
filter(id == i) |>
# select(-lactate) |>
lactate_threshold(
intensity_column = "intensity",
lactate_column = "zelemiq_avg_z",
fit = "3rd degree polynomial",
method = c("Log-log", "Dmax", "LTP"),
include_baseline = TRUE,
sport = "cycling",
loglog_restrainer = 1,
plot = FALSE
)
thresholds <- rbind(thresholds,
data.frame(id = i,
method_category = lactate_thresholds$method_category,
method = lactate_thresholds$method,
fitting = lactate_thresholds$fitting,
intensity_lactate = lactate_thresholds$intensity,
lactate = lactate_thresholds$lactate,
intensity_zelemiq = zelemiq_thresholds$intensity,
zelemiq = zelemiq_thresholds$lactate)
)
}
}
View(thresholds)
targets::tar_make()
targets::tar_load(thresholds)
View(thresholds)
targets::tar_make()
targets::tar_make()
targets::tar_make()
targets::tar_make()
targets::tar_make()
targets::tar_make()
targets::tar_make()
facet_grid(.~method" +
thresholds |>
filter(str_detect(method, pattern = "Log", negate = TRUE)) |>
thresholds |>
filter(str_detect(method, pattern = "Log", negate = TRUE)) |>
ggplot(aes(x = intensity_lactate, y = intensity_zelemiq)) +
geom_abline(intercept = 0, slope = 1, linetype = "dashed") +
geom_point() +
geom_text(data = thresholds_agree,
aes(label = glue::glue("Bias = {round(bias,2)} [95%CI: {round(bias_lower,2)}, {round(bias_upper,2)}]")),
x = 135,
y = 250,
size = 2
) +
geom_text(data = thresholds_agree,
aes(label = glue::glue("Lower LOA = {round(lower_loa,2)} [90%CI: {round(lower_loa_lower,2)}, {round(lower_loa_upper,2)}]")),
x = 135,
y = 235,
size = 2
) +
geom_text(data = thresholds_agree,
aes(label = glue::glue("Upper LOA = {round(upper_loa,2)} [90%CI: {round(upper_loa_lower,2)}, {round(upper_loa_upper,2)}]")),
x = 135,
y = 220,
size = 2
) +
geom_text(data = thresholds_agree,
aes(label = paste(glue::glue("rho[CCC] == {round(ccc,2)}"))),
x = 235,
y = 125,
size = 2,
parse = TRUE
) +
geom_text(data = thresholds_agree,
aes(label = glue::glue("[95%CI: {round(ccc_lower,2)}, {round(ccc_upper,2)}]")),
x = 235,
y = 110,
size = 2
) +
facet_grid(.~method) +
labs(x = "Threshold determined by blood lactate (Watts)",
y = "Threshold determined by Zelemiq Ltd (Watts)",
title = "Agreement of thresholds detected by different methods") +
theme_bw() +
theme(panel.grid=element_blank(),
plot.title = element_markdown())
View(thresholds)
targets::tar_load(thresholds)
thresholds |>
filter(str_detect(method, pattern = "Log", negate = TRUE)) |>
ggplot(aes(x = intensity_lactate, y = intensity_zelemiq)) +
geom_abline(intercept = 0, slope = 1, linetype = "dashed") +
geom_point() +
geom_text(data = thresholds_agree,
aes(label = glue::glue("Bias = {round(bias,2)} [95%CI: {round(bias_lower,2)}, {round(bias_upper,2)}]")),
x = 135,
y = 250,
size = 2
) +
geom_text(data = thresholds_agree,
aes(label = glue::glue("Lower LOA = {round(lower_loa,2)} [90%CI: {round(lower_loa_lower,2)}, {round(lower_loa_upper,2)}]")),
x = 135,
y = 235,
size = 2
) +
geom_text(data = thresholds_agree,
aes(label = glue::glue("Upper LOA = {round(upper_loa,2)} [90%CI: {round(upper_loa_lower,2)}, {round(upper_loa_upper,2)}]")),
x = 135,
y = 220,
size = 2
) +
geom_text(data = thresholds_agree,
aes(label = paste(glue::glue("rho[CCC] == {round(ccc,2)}"))),
x = 235,
y = 125,
size = 2,
parse = TRUE
) +
geom_text(data = thresholds_agree,
aes(label = glue::glue("[95%CI: {round(ccc_lower,2)}, {round(ccc_upper,2)}]")),
x = 235,
y = 110,
size = 2
) +
facet_grid(.~method) +
labs(x = "Threshold determined by blood lactate (Watts)",
y = "Threshold determined by Zelemiq Ltd (Watts)",
title = "Agreement of thresholds detected by different methods") +
theme_bw() +
theme(panel.grid=element_blank(),
plot.title = element_markdown())
targets::tar_make()
targets::tar_make()
targets::tar_make()
14/5
10/2.8
targets::tar_make()
targets::tar_make()
targets::tar_make()
targets::tar_make()
targets::tar_make()
targets::tar_make()
